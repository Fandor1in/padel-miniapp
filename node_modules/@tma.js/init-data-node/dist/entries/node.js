import { function as _function, either } from "fp-ts";
import { createHmac as createHmac$1 } from "node:crypto";
import { h as hashToken$1, s as signFp$1, a as signDataFp$1, v as validateFp$1, b as bufferToArrayBuffer } from "./parsing-Cjnt3_z4.js";
import { A, E, H, S, c, i, e, p, d, f, g } from "./parsing-Cjnt3_z4.js";
import { deepSnakeToCamelObjKeys } from "@tma.js/toolkit";
function textToBuffer(text) {
  return Buffer.from(typeof text === "string" ? text : new Uint8Array(text));
}
const createHmac = (data, key) => {
  return bufferToArrayBuffer(
    createHmac$1("sha256", textToBuffer(key)).update(textToBuffer(data)).digest()
  );
};
function hashToken(token) {
  return Buffer.from(hashToken$1(token, createHmac));
}
function isValid(value, token, options) {
  return _function.pipe(
    validateFp(value, token, options),
    either.match(() => false, () => true)
  );
}
function signFp(data, key, authDate, options) {
  return signFp$1(data, key, authDate, signDataFp, options);
}
function sign(data, key, authDate, options) {
  return _function.pipe(
    signFp(data, key, authDate, options),
    either.match((e2) => {
      throw e2;
    }, (v) => v)
  );
}
function signDataFp(data, key, options) {
  return signDataFp$1(false, data, key, createHmac, options);
}
function signData(data, key, options) {
  return _function.pipe(
    signDataFp(data, key, options),
    either.match((e2) => {
      throw e2;
    }, (v) => v)
  );
}
function validateFp(value, token, options) {
  return validateFp$1(false, value, token, signDataFp, options);
}
function validate(value, token, options) {
  _function.pipe(
    validateFp(value, token, options),
    either.mapLeft((error) => {
      throw error;
    })
  );
}
export {
  A as AuthDateInvalidError,
  E as ExpiredError,
  H as HexStringLengthInvalidError,
  S as SignatureInvalidError,
  c as SignatureMissingError,
  deepSnakeToCamelObjKeys,
  hashToken,
  isValid,
  i as isValid3rd,
  e as isValid3rdFp,
  p as parse,
  d as parseFp,
  sign,
  signData,
  signDataFp,
  signFp,
  validate,
  f as validate3rd,
  g as validate3rdFp,
  validateFp
};
//# sourceMappingURL=node.js.map
